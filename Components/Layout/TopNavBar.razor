@inject AuthenticationStateProvider _authStateProvider
@* @inject SharedStateService _sharedstateService
@inject IShoppingCartRepository _shoppingCartRepository
 *@
<nav class="navbar navbar-expand-md navbar-dark modern-navbar">
	<div class="container-fluid navbar-container">
		<a class="navbar-brand brand-wrapper" href="">
			<div class="logo-container">
				<img src="/images/logomen.png" alt="Logo" width="56" height="56" class="brand-logo">
			</div>
		</a>
		<button class="navbar-toggler custom-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
				aria-controls="navbarCollapse" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarCollapse">
			<ul class="navbar-nav me-auto mb-2 mb-md-0 main-nav">
				<li class="nav-item">
					<NavLink class="nav-link nav-link-custom" href="/" Match="NavLinkMatch.All">
						<i class="bi bi-house-door-fill nav-icon"></i>
						<span class="nav-text">Home</span>
					</NavLink>
				</li>
				<li class="nav-item">
					<NavLink class="nav-link nav-link-custom" href="/cart">
						<i class="bi bi-cart3 nav-icon"></i>
						<span class="nav-text">Cart</span>
					</NavLink>
				</li>
				<li class="nav-item">
					<NavLink class="nav-link nav-link-custom" href="/order/list">
						<i class="bi bi-card-list nav-icon"></i>
						<span class="nav-text">Orders</span>
					</NavLink>
				</li>
			</ul>
			<ul class="navbar-nav auth-nav mb-2 mb-md-0">
				<AuthorizeView>
					<Authorized>
						<li class="nav-item user-welcome">
							<NavLink class="nav-link nav-link-custom user-link" href="Account/Manage">
								<i class="bi bi-person-circle nav-icon"></i>
								<span class="nav-text">@context?.User?.Identity?.Name</span>
							</NavLink>
						</li>
						<li class="nav-item">
							<form action="Account/Logout" method="post" class="logout-form">
								<AntiforgeryToken />
								<input type="hidden" name="ReturnUrl" value="" />
								<button type="submit" class="btn btn-logout">
									<i class="bi bi-box-arrow-right"></i>
									<span>Logout</span>
								</button>
							</form>
						</li>
					</Authorized>
					<NotAuthorized>
						<li class="nav-item">
							<NavLink class="nav-link nav-link-custom" href="Account/Register">
								<i class="bi bi-person-plus nav-icon"></i>
								<span class="nav-text">Register</span>
							</NavLink>
						</li>
						<li class="nav-item">
							<NavLink class="btn btn-login" href="Account/Login">
								<i class="bi bi-box-arrow-in-right"></i>
								<span>Login</span>
							</NavLink>
						</li>
					</NotAuthorized>
				</AuthorizeView>
			</ul>
		</div>
	</div>
</nav>


@code {
	// protected override void OnInitialized()
	// {
	// 	_sharedstateService.OnChange += OnSharedStateChange;
	// 	GetInitialCount();
	// }

	// private void OnSharedStateChange()
	// {
	// 	InvokeAsync(StateHasChanged);
	// }

	// public async Task GetInitialCount()
	// {
	// 	var authState = await _authStateProvider.GetAuthenticationStateAsync();
	// 	var user = authState.User;

	// 	_sharedstateService.TotalCartCount =
	// 	await _shoppingCartRepository.GetTotalCartCartCountAsync(user?.FindFirst(u => u.Type.Contains("nameidentifier"))?.Value);

	// }
	// public void Dispose()
	// {
	// 	_sharedstateService.OnChange -= OnSharedStateChange;
	// }
}